# Мастерская 1  

## Постановка задачи  

Заказчик предоставил данные о стартапах, работавших в период с 1970 по 2018 годы. Необходимо создать модель, которая сможет предсказать, какие из этих стартапов закроются.  

## Цель исследования  
 - Разработать модель машинного обучения для предсказания продолжения деятельности стартапа.   
 - Провести полноценный разведочный анализ и сформировать рекомендации будущим создателям стартапов (какие факторы влияют на успешность стартапа).

## Описание данных  

Заказчик предоставил данные в двух файлах: тренировочный набор (около 53к записей) и тестовый набор (около 13к записей). Тренировочный набор содержит целевой признак status, указывающий на то, закрылся стартап или продолжает действовать. Временной период - '1970-01-01' по '2018-01-01'. Дата формирования выгрузки - '2018-01-01'  

 - **name** - Название стартапа
 - **category_list** - Список категорий, к которым относится стартап
 - **funding_total_usd** - Общая сумма финансирования в USD
 - **status** - Статус стартапа (закрыт или действующий)
 - **country_code** - Код страны
 - **state_code** - Код штата
 - **region** - Регион
 - **city** - Город
 - **funding_rounds** - Количество раундов финансирования
 - **founded_at** - Дата основания
 - **first_funding_at** - Дата первого раунда финансирования
 - **last_funding_at** - Дата последнего раунда финансирования
 - **closed_at** - Дата закрытия стартапа (если применимо)
 - **lifetime** - Время существования стартапа в днях
  
## План работ  
 - загрузка и ознакомление с данными,
 - предварительная обработка,
 - полноценный разведочный анализ,
 - разработка новых синтетических признаков,
 - проверка на мультиколлинеарность,
 - отбор финального набора обучающих признаков,
 - выбор и обучение моделей,
 - итоговая оценка качества предсказания лучшей модели,
 - анализ важности ее признаков,
 - подготовка отчета по исследованию.

1. **Заказчик предоставил данные о стартапах, работавших в период с 1970 по 2018 годы и попросил выполнить следующие задачи:**  
- Разработать модель машинного обучения для предсказания продолжения деятельности стартапа.  
- Провести полноценный разведочный анализ и сформировать рекомендации будущим создателям стартапов (какие факторы влияют на успешность стартапа).

Заказчик предоставил данные в двух файлах: тренировочный набор (около 53к записей) и тестовый набор (около 13к записей). Тренировочный набор содержит целевой признак status, указывающий на то, закрылся стартап или продолжает действовать. Временной период - '1970-01-01' по '2018-01-01'. Дата формирования выгрузки - '2018-01-01'  

2. **Предобработка данных:**
- Исрпавлены типы данных.  
- Наименования столбцов не нуждались в исправлениях.  
- Были найдены пропуски и заполнены.  
- Явных дубликатов не было найдено.  
- Были добавлены новые признаки **lifetime_category** и **first_category**.  
  
3. **Исследовательский анализ:**
- В ходе анализа были выявлены аномальные значения и по итогу удалены. Процент удаленных данных не составил более 5%.
- Так же проведен корреляционный анализ данных.  

**Было выявлено следующее:**  
- Целевой признак status имеет дисбаланс, примерно 90%-operating и 10%-closed.  
- Так же на графике с funding_total_usd было заметно смещение вызванное выбросами.  
- Больше всего стартапов с кодом страны USA(30тыс.).  
- Примерно у 5тыс. стартапов не указан код страны.  
- Чуть больше 10тыс. стартапов имеют state_code - CA.  
- Почти 7тыс. стартапов без state_code.  
- 7тыс. стартапов находятся в регионе SF Bay Area.  
- Для 6.4тыс. стартапов не указан регион.  
- Для более чем 6тыс. стартапов не указан город.  
- 3тыс. стартапов в San Francisco.  
- Между целевым признаком status и признаком lifetime присутствует мультиколлинеарность.  
- Признак lifetime коррелирует с признаками country_code(0.97), lifetime_category(1.00) и first_category(0.93.  
- Признак country_code коррелирует с признаком first_category(0.83).  
- Закрытые стартапы зачастую имеют низкое количество дней(lifetime).

4. **Далее была проведена подготовка данных с использованием пайплайнов и кодирование целевого признака "status" с помощью LabelEncoder.**

5. **В ходе обучения были взяты 3 модели машинного обучения:**
- LogisticRegression
- DecisionTreeClassifier
- KNN

Для подбора гиперпараметров мы использовали OptunaSearchCV. Лучше моделью оказалась DecisionTreeClassifier с показателем метрики F1-score - 0.972. Было найдено оптимальное количество признаков для наилучшего качества метрики - 7 признаков. Так же найден подходящий порог классификации - 0.55.  

**При F1-score равном 0.974 модель предсказала следующее:**  
  
- **TP** = 11242, это значит, что модель 11242 раза верно предсказала продолжение работы стартапов.  
- **FP** = 458, модель 458 раз неверно предсказала закрытие стартапов.  
- **TN** = 759, в данном случае модель 759 раз верно предсказала закрытие стартапов.  
- **FN** = 134, модель 134 раза ошиблась, предсказав закрытие стартапов, которые не закрылись.

6. **По итогам проведенной работы можно сделать следующие выводы:**
- В данных присутствуют данные о стартапах преимущественно из северной америки и западной европы. В данном случае там наиболее высокаа конкуренция, но так же и шансы на успех выше.
- В большинстве стартапов главными категориями являются биотехнология, програмное обеспечение, реклама и электронная коммерция.
- В среднем закрывшиеся стартапы работали около 3-х лет, так что для успеха стартапу необходимо преодолеть данный барьер.
